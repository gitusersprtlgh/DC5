/*global document window*/(function(e){"use strict";e.fn.extend({LoaderAnimation:function(t){var n={lineWidth:20,color:"#ffffff",glowColor:"#00aeff",radius:40,font:"normal 14px Arial"},r=e(this),i=e.extend(n,t),s=this,o=i.lineWidth,u=i.color,a=i.glowColor,f=i.radius,l=i.font;this.currentPercentage=0;var c=e(window),h=Math.PI,p=1.5*h,d=0,v=!!document.createElement("canvas").getContext,m=e(window).width(),g=e(window).height(),y,b,w,E=function(){b.text((s.currentPercentage|0)+"%")},S=function(){v&&w.clearRect(0,0,m,g);return!0},x=function(){var e=.02*s.currentPercentage,t=m/2,n=g/2;d=e*h+p;S();w.restore();w.beginPath();w.font=l;w.fillStyle=u;w.textAlign="center";w.textBaseline="middle";w.fillText((s.currentPercentage|0)+"%",t,n);w.lineWidth=o;w.strokeStyle=u;if(a){w.shadowOffsetX=0;w.shadowOffsetY=0;w.shadowBlur=20;w.shadowColor=a}w.arc(t,n,f,p,d,!1);w.stroke();w.save()},T=function(){if(s.currentPercentage===100){r.delay(1e3).fadeOut(function(){r.remove()});c.off("resize.preloader")}},N=function(){m=e(window).width();g=e(window).height();if(v){y[0].width=m;y[0].height=g}r.width(m);r.height(g)};s.init=function(){if(v){y=e("<canvas>");r.append(y);w=y[0].getContext("2d")}else{b=e("<i class='fallback'></i>");r.append(b)}N();c.on("resize.preloader",N)};s.update=function(t){e.Animation(s,{currentPercentage:t},{duration:3e3}).progress(function(){v?x():E()}).done(T)};this.init();return this}})})(jQuery);