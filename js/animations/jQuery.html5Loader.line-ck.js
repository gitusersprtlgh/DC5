/*global document window*/(function(e){"use strict";e.fn.extend({LoaderAnimation:function(t){var n={lineWidth:1,color:"#333333",glowColor:null,radius:40,font:"normal 23px Lobster Two"},r=e(this),i=e.extend(n,t),s=this,o=i.lineWidth,u=i.color,a=i.glowColor,f=i.radius,l=i.font;this.currentPercentage=0;var c=e(window),h=!!document.createElement("canvas").getContext,p=e(window).width(),d=e(window).height(),v,m,g,y=function(){m.text((s.currentPercentage|0)+"%")},b=function(){h&&g.clearRect(0,0,p,d);return!0},w=function(){var e=p,t=d,n=p/2,r=d/2,i=e/100*s.currentPercentage;b();g.restore();g.beginPath();g.font=l;g.fillStyle=u;g.textAlign="center";g.fillText((s.currentPercentage|0)+"%",n,r-(o+10));g.lineWidth=o;g.strokeStyle=u;if(a){g.shadowOffsetX=0;g.shadowOffsetY=0;g.shadowBlur=10;g.shadowColor=a}g.moveTo(n-e/2,r);g.lineTo(i,r);g.stroke();g.save()},E=function(){if(s.currentPercentage===100){r.delay(1e3).fadeOut(function(){r.remove()});c.off("resize.preloader")}},S=function(){p=e(window).width();d=e(window).height();if(h){v[0].width=p;v[0].height=d}r.width(p);r.height(d)};s.init=function(){if(h){v=e("<canvas>");r.append(v);g=v[0].getContext("2d")}else{m=e("<i class='fallback'></i>");r.append(m)}S();c.on("resize.preloader",S)};s.update=function(t){e.Animation(s,{currentPercentage:t},{duration:3e3}).progress(function(){h?w():y()}).done(E)};this.init();return this}})})(jQuery);